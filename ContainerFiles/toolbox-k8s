FROM quay.io/fedora/fedora-toolbox:42

LABEL com.github.containers.toolbox="true" \
      usage="This image is meant to be used with the toolbox or distrobox command" \
      summary="An example ContainerFile to demonstrate multiple image builds." \
      maintainer="faeizmahrus@outlook.com"

# Copy the setup scripts and package list
COPY ../scripts/toolbox-k8s.sh /
COPY ../scripts/distrobox-shims.sh /
COPY ../packages/toolbox-k8s.packages /

# add utils repo
RUN dnf copr enable -y magnusrc/k9s
RUN dnf copr enable -y merded/kubectx 
RUN dnf copr enable -y enmanuelmoreira/mapanare-labs 
RUN dnf copr enable -y johan/fedora-rpms 

# Run the setup scripts
RUN chmod +x toolbox-k8s.sh distrobox-shims.sh && /toolbox-k8s.sh
RUN rm /toolbox-k8s.sh /distrobox-shims.sh /toolbox-k8s.packages

# install kubetail
RUN curl -sS https://www.kubetail.com/install.sh | bash
